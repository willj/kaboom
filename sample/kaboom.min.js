if(void 0===kaboom)var kaboom={};if(kaboom.createGame=function(){return Object.create(kaboom.game)},kaboom.game={gameOverCallback:null,drawCallback:null,updateCallback:null,updateOncePerSecondCallback:null,initialize:function(t,s){this.settings=t,this.gameLoopIntervalId,this.actors=[],this.frameCount=0,this.approxRunTimeInSeconds=0,this.gameOver=!1,this.canvas=Object.create(kaboom.canvas),this.canvas.create(this.settings,this.approxRunTimeInSeconds),this.assets=Object.create(kaboom.assetManager),this.sounds=Object.create(kaboom.sound),this.sounds.init(this.assets.sounds,this.settings),this.assets.loadedCallback=s,this.assets.loadAll(this.settings)},startGame:function(){var t=this;this.gameLoopIntervalId=setInterval(function(){t.update(),t.draw()},1e3/t.settings.framesPerSecond)},stopGame:function(){clearInterval(this.gameLoopIntervalId),this.gameOver=!0,this.actors.splice(0,this.actors.length),this.gameOverCallback&&this.gameOverCallback.apply(this)},restartGame:function(){clearInterval(this.gameLoopIntervalId),this.actors.splice(0,this.actors.length),this.draw(),this.frameCount=0,this.approxRunTimeInSeconds=0,this.gameOver=!1,this.startGame()},update:function(){this.frameCounter(),this.updateOncePerSecond();for(var t=[],s=0;s<this.actors.length;s++)this.actors[s].update(),this.actors[s].killed&&t.push(s);for(var s=0;s<t.length;s++)this.actors.splice(t[s],1);this.updateCallback&&this.updateCallback.apply(this)},draw:function(){this.canvas.context.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight());for(var t=0;t<this.actors.length;t++)this.actors[t].draw(this.canvas.context);this.drawCallback&&this.drawCallback.apply(this)},frameCounter:function(){this.frameCount=(this.frameCount+1)%this.settings.framesPerSecond},updateOncePerSecond:function(){0===this.frameCount&&(this.approxRunTimeInSeconds+=1,this.updateOncePerSecondCallback&&this.updateOncePerSecondCallback.apply(this,[this.approxRunTimeInSeconds]))}},void 0===kaboom)var kaboom={};if(kaboom.createActor=function(t,s,i,e){var a=Object.create(kaboom.actor);return a.init(t,s,i,e),a},kaboom.actor={init:function(t,s,i,e){this.name=t,this.sprite=s,this.posX=i||0,this.posY=e||0,this.killed=!1,this.currentState="initial",this.currentStateFrameCount=this.sprite.states[this.currentState].length,this.currentFrame=0,this.currentSourceX=this.sprite.states[this.currentState][this.currentFrame]*this.sprite.width,this.tickCount=0,this.ticksPerUpdate=1,this.ticksToLive=-2,this.velocityX=0,this.velocityY=0,this.rotation=0,this.shouldRotate=!1,this.opacity=1,this.fadeState=null,this.scaleFactor=1,this.scaleState=null},kill:function(){this.killed=!0},fade:function(t,s){this.fadeState={start:t,end:s},this.opacity=t},update:function(){this.tickCount=(this.tickCount+1)%this.ticksPerUpdate,this.ticksToLive>-2&&--this.ticksToLive<1&&(this.killed=!0),this.posX+=this.velocityX,this.posY+=this.velocityY,this.updateFade(),this.updateScale(),this.updateFrame()},draw:function(t){if(this.shouldRotate){t.save();var s=this.posX+this.sprite.width/2,i=this.posY+this.sprite.height/2;t.translate(s,i),t.rotate(kaboom.util.degreesToRadians(this.rotation)),t.translate(-s,-i)}this.opacity<1&&(t.globalAlpha=this.opacity),t.drawImage(this.sprite.image,this.currentSourceX,this.sprite.sourceY,this.sprite.width,this.sprite.height,this.scaledPosX(),this.scaledPosY(),this.scaledWidth(),this.scaledHeight()),this.opacity<1&&(t.globalAlpha=1),this.shouldRotate&&t.restore()},scaledPosX:function(){return 1==this.scaleFactor?this.posX:this.posX-(this.scaledWidth()-this.sprite.width)/2},scaledPosY:function(){return 1==this.scaleFactor?this.posY:this.posY-(this.scaledHeight()-this.sprite.height)/2},scaledWidth:function(){return this.sprite.width*this.scaleFactor},scaledHeight:function(){return this.sprite.height*this.scaleFactor},scale:function(t,s){this.scaleState={start:t,end:s},this.scaleFactor=t},rotateBy:function(t){this.rotation+=t,this.shouldRotate=!0},rotateTo:function(t){this.rotation=t,this.shouldRotate=!0},setState:function(t){this.currentState=t,this.currentStateFrameCount=this.sprite.states[this.currentState].length,this.currentFrame=-1},updateFrame:function(){this.tickCount>0||(this.currentFrame+=1,this.currentFrame>this.currentStateFrameCount&&(this.currentFrame=0),"string"==typeof this.sprite.states[this.currentState][this.currentFrame]?"die"===this.sprite.states[this.currentState][this.currentFrame]?this.killed=!0:"fadeOut"===this.sprite.states[this.currentState][this.currentFrame]?this.fade(1,0):"fadeIn"===this.sprite.states[this.currentState][this.currentFrame]?this.fade(0,1):this.setState(this.sprite.states[this.currentState][this.currentFrame]):this.currentSourceX=this.sprite.states[this.currentState][this.currentFrame]*this.sprite.width)},updateFade:function(){this.fadeState&&(this.fadeState.start<this.fadeState.end?this.opacity<=this.fadeState.end&&(this.opacity=this.opacity+.1,this.opacity>=this.fadeState.end&&(this.opacity=this.fadeState.end,this.fadeState=null)):this.opacity>=this.fadeState.end&&(this.opacity=this.opacity-.1,this.opacity<=this.fadeState.end&&(this.opacity=this.fadeState.end,this.fadeState=null)))},updateScale:function(){this.scaleState&&(this.scaleState.start<this.scaleState.end?this.scaleFactor<=this.scaleState.end&&(this.scaleFactor=this.scaleFactor+.1,this.scaleFactor>=this.scaleState.end&&(this.scaleFactor=this.scaleState.end,this.scaleState=null)):this.scaleFactor>=this.scaleState.end&&(this.scaleFactor=this.scaleFactor-.1,this.scaleFactor<=this.scaleState.end&&(this.scaleFactor=this.scaleState.end,this.scaleState=null)))},getHitRect:function(){return{top:this.posY+this.sprite.hitMargin.top,right:this.posX+(this.sprite.width-this.sprite.hitMargin.right),bottom:this.posY+this.sprite.height-this.sprite.hitMargin.bottom,left:this.posX+this.sprite.hitMargin.left}},contains:function(t){var s=this.getHitRect(),i=t.getHitRect();return s.bottom>=i.bottom&&s.top<=i.top&&s.left<=i.left&&s.right>=i.right},touches:function(t){var s=this.getHitRect(),i=t.getHitRect();return s.top<=i.bottom&&s.bottom>=i.top&&s.left<=i.right&&s.right>=i.left}},void 0===kaboom)var kaboom={};if(kaboom.assetManager={images:{},sounds:{},sprites:{},assetsLoaded:0,loadedCallback:null,loadAll:function(t){if(this.settings=t,0==this.settings.assetMap.length)return void(this.loadedCallback&&this.loadedCallback.apply(this));for(var s=0;s<this.settings.assetMap.length;s++)"Image"===this.settings.assetMap[s].fileType?this.loadImage(this.settings.assetMap[s]):"Sound"===this.settings.assetMap[s].fileType&&this.loadSound(this.settings.assetMap[s])},loadImage:function(t){var s=new Image;this.images[t.fileName]=s,s.onload=this.assetLoaded(t),s.src=this.settings.assetDirectory+t.fileName},loadSound:function(t){var s=new Audio;this.sounds[t.name]=s,s.onload=this.assetLoaded(t),s.src=this.settings.assetDirectory+t.fileName},assetLoaded:function(t){if(this.assetsLoaded+=1,"Image"===t.fileType)for(var s=0;s<t.sprites.length;s++){var i=t.sprites[s];this.sprites[i.name]=Object.create(kaboom.sprite),this.sprites[i.name].init(this.images[t.fileName],i.startX,i.startY,i.width,i.height,i.states,i.hitMargin)}this.assetsLoaded==this.settings.assetMap.length&&this.loadedCallback&&this.loadedCallback.apply(this)}},void 0===kaboom)var kaboom={};if(kaboom.canvas={create:function(t){this.settings=t,this.containerElement=document.getElementById(this.settings.containerElementId),this.settings.canvasWidth&&this.settings.canvasHeight||this.detectContainerSize(),this.canvasElement=document.createElement("canvas"),this.context=this.canvasElement.getContext("2d"),this.canvasElement.width=this.settings.canvasWidth,this.canvasElement.height=this.settings.canvasHeight,this.containerElement.appendChild(this.canvasElement)},resize:function(t,s){t&&s?(this.settings.canvasWidth=t,this.settings.canvasHeight=s):this.detectContainerSize(),this.canvasElement.width=this.settings.canvasWidth,this.canvasElement.height=this.settings.canvasHeight},detectContainerSize:function(){this.settings.canvasWidth=this.containerElement.clientWidth,this.settings.canvasHeight=this.containerElement.clientHeight},getWidth:function(){return this.canvasElement.width},getHeight:function(){return this.canvasElement.height},animationClassApplied:!1,applyAnimationClass:function(t,s){0==this.animationClassApplied&&(this.canvasElement.className=t,this.animationClassApplied=!0,setTimeout(this.removeAnimationClass(this),1e3*s))},removeAnimationClass:function(t){return function(){t.canvasElement.className="",t.animationClassApplied=!1}}},void 0===kaboom)var kaboom={};if(kaboom.sound={sounds:null,settings:null,init:function(t,s){this.sounds=t,this.settings=s},play:function(t,s,i){var e=s||!1,a=i||!1;null!=this.sounds[t]&&(!0!==this.settings.playAllSounds&&!1!==e||(this.sounds[t].loop=a,this.sounds[t].play()))},pause:function(t){null!=this.sounds[t]&&this.sounds[t].pause()},stop:function(t){null!=this.sounds[t]&&(this.sounds[t].pause(),this.sounds[t].currentTime>0&&(this.sounds[t].currentTime=0))},activateSounds:function(){if(navigator.userAgent.search(/iPad|iPhone|Android|Linux/))for(var t=0;t<this.settings.assetMap.length;t++)"Sound"===this.settings.assetMap[t].fileType&&(this.sounds[this.settings.assetMap[t].name].play(),this.sounds[this.settings.assetMap[t].name].pause())}},void 0===kaboom)var kaboom={};if(kaboom.sprite={init:function(t,s,i,e,a,n,h){this.image=t,this.sourceX=s||0,this.sourceY=i||0,this.width=e||t.width,this.height=a||t.height,this.states=n,this.hitMargin=h||0,"number"==typeof this.hitMargin&&(this.hitMargin={top:this.hitMargin,right:this.hitMargin,bottom:this.hitMargin,left:this.hitMargin})}},void 0===kaboom)var kaboom={};kaboom.util={getRandomInt:function(t,s){return Math.floor(Math.random()*(s-t))+t},degreesToRadians:function(t){return t*(Math.PI/180)}};